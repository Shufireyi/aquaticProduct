<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">  
		<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/jquery-3.1.1.min.js" ></script>
		<style type="text/css">
			ul { cursor: pointer;}
			
			.pagination { float: right;}
		</style>
	</head>
	<body>
		<table class="table table-hover">
			<caption>数据展示</caption>
			<thead>
				<tr>
					<th>公司id</th>
					<th>工厂id</th>
					<th>传感器</th>
					<th>传感器类型</th>
					<th>value</th>
					<th>时间</th>
				</tr>
			</thead>
			<tbody id="tb">
				<tr>
					<td>Tanmay</td>
					<td>Bangalore</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
				</tr>
				<tr>
					<td>Tanmay</td>
					<td>Bangalore</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
				</tr>
				<tr>
					<td>Tanmay</td>
					<td>Bangalore</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
					<td>560001</td>
				</tr>
			</tbody>
		</table>		
		<ul class="pagination" id="pagination">
		    <li><a onclick="listPagel()">&laquo;</a></li>
		    <li><a onclick="listPage(1,1)">1</a></li>
		    <li><a onclick="listPage(2,2)">2</a></li>
		    <li><a onclick="listPage(3,3)">3</a></li>
		    <li><a onclick="listPage(4,4)">4</a></li>
		    <li><a onclick="listPage(5,5)">5</a></li>
		    <li><a onclick="listPager()">&raquo;</a></li>
		</ul>
	</body>
	<script>

		var nowpage = 1;
		var n = 1;
		var totalpage = 30;
		var ul = document.getElementById("pagination");
		ul.children[1].children[0].style.backgroundColor = " #ddd";    //默认显示第一页

		list(1);

		function list(page){
			$.ajax({
				type:"post",
				url:"/dataDisplay/queryHistoryDataByPage.action",
				data:{
					currentPage:page			
				},
				success:function(returnValue){
                    totalpage = returnValue.page.totalPage;
                    var item = returnValue.list;
                    for(var i=0;i<3;i++){
//                        alert(item[i].value);
                        var tbody = document.getElementById("tb");
                        var tr = document.createElement("tr");
                        tbody.appendChild(tr);

//                        addtd(item[i].companyid, tr);
//                        addtd(item[i].factoryid, tr);
//                        addtd(item[i].sensorid, tr);
//                        addtd(item[i].type, tr);
//                        addtd(item[i].value, tr);
//                        addtd(item[i].time, tr);
                        document.getElementById("tb").children[i].children[0].innerHTML = item[i].companyid;
                        document.getElementById("tb").children[i].children[1].innerHTML = item[i].factoryid;
                        document.getElementById("tb").children[i].children[2].innerHTML = item[i].sensorid;
                        document.getElementById("tb").children[i].children[3].innerHTML = item[i].type;
                        document.getElementById("tb").children[i].children[4].innerHTML = item[i].value;
                        document.getElementById("tb").children[i].children[5].innerHTML = item[i].time;
                    }
				}
			});
		}
		
		function addtd(obj,tr){
			var td = document.createElement("td");
			td.innerHTML = obj;
			tr.appendChild(td);
		}
		
		function getDateTime(date) {
			    var year = date.getFullYear();
			    var month = date.getMonth() + 1;
			    var day = date.getDate();
		        var hh = date.getHours();
			    var mm = date.getMinutes();
			    var ss = date.getSeconds();
			    return year + "-" + month + "-" + day+" "+hh+":"+mm+":"+ss; 
		}
		
		//分页功能
		function listPage(page,flag){                          //flag为位置标记
			if(page >0 && page <= totalpage){
				var ul = document.getElementById("pagination");
				//$('#tb tr').remove();
				for(var i=1;i<6;i++){
					ul.children[i].children[0].style.backgroundColor = "white";  
				}

				if(flag >=2 && flag <=4){	
					ul.children[flag].children[0].style.backgroundColor = " #ddd"; //选中为灰色
					nowpage = page;
					n = flag;
				}else if(flag == 1){
						if(document.getElementById("pagination").children[1].children[0].innerHTML == 1){
							ul.children[1].children[0].style.backgroundColor = " #ddd"; 
						}else{
							ul.children[2].children[0].style.backgroundColor = " #ddd";
						}
						if(page != 1){
							for(var i=1;i<6;i++){
								ul.children[i].children[0].setAttribute("onclick","listPage("+(page+i-2)+","+i+")");
								ul.children[i].children[0].innerHTML = page+i-2;
							}
						}
						nowpage = page;
						if(page == 1){ 
							n = flag;
						}else{
							n = flag+1;
						}
				}else if(flag == 5){
						if(document.getElementById("pagination").children[5].children[0].innerHTML == totalpage){
							ul.children[5].children[0].style.backgroundColor = " #ddd"; 
						}else{
							ul.children[4].children[0].style.backgroundColor = " #ddd"; 
						}
						if(page < totalpage){
							for(var i=1;i<6;i++){
								ul.children[i].children[0].setAttribute("onclick","listPage("+(page+i-4)+","+i+")");
								ul.children[i].children[0].innerHTML = page+i-4;
							}
						}
						nowpage = page;
						if(page == totalpage){
							n = flag;							
						}else{
							n = flag-1;
						}
				}
				list(page);
			}
		}
		
		function listPagel(){
			if(n == 1){
				listPage(nowpage-1,n);
			}else{
				listPage(nowpage-1,n-1);
			}
		}
		
		function listPager(){
			if(n == 5){
				listPage(nowpage+1,n);
			}else{
				listPage(nowpage+1,n+1);
			}
		}
	</script>
</html>
